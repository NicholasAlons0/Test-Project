attach(Household_Pulse_data)
summary(Household_Pulse_data)
detach()
#REGSSION FOR FIRST QUESITION
regressions <- lm(RECVDVACC ~ EEDUC*REGION)
summary(regressions)

regressions <- lm(vaccine ~ education*regions)
summary(regressions)

variabl<-lm(as.numeric(EEDUC)~ RECVDVACC* REGION)
summary(variabl)

# People with an advance degree, from the south region are not as significant because the 
# t value is to close to zero, the p value is above the level of significance.
# Thus, I fail to reject the null hypothesis for people in the south with an advance 
# degree have and conclude there is no significant relationship between getting the vaccine and
# and people in the south with an advance degree.
# Compared to people in with education high school in region west, that have a t-stat that 
# is far away from  zero and a p_value below the level of significance, I can say with 99%
# confidence that we reject th null hypothesis that there is no relationship between getting the 
#vaccine and are in favor of the alternative hypothesis that there is a relationship.
# the same would apply, to the variables that have no significance stars, we fail to reject trhe null
# hypotheses that there is no relationship. whereas, all the variables that have at least one star,
# we reject the null hypothesis depending the level of significance

regression11<-lm(as.numeric(RECVDVACC)~ EEDUC* GENID_DESCRIBE)
summary(regression11)

genderid <- as.numeric(GENID_DESCRIBE)
regressions3 <- lm(genderid ~ EEDUC*RECVDVACC)
summary(regressions3)

# In the regression, the Null Hypothesis is that there is no significant difference or relationship between the genderID
# and educations and people the receive the vaccine,
# while the alternative hypothesis states there is a significant difference or relationship.
# The t-stats, p-values and confidence intervals of the someone with advance education,
# that have received the vaccine is significant because of the p value that is 0.0056, which
# below the level of significance and has a t-stats of 2.767, which is decently far from 0,
#therefore we reject the null hypothesis that there is no relationship and conclude that
# there is a relationship between genderID and people advance education, that have received the vaccine.
# for the ones with no significance, like somecollege and no covid vaccine, 
# we fail to reject the null hypothesis and conclude there is no relationship between genderID AND 
# education level or people that not get the covid vaccine.


#NUMBER 3

#so I will make Hispanic into a numeric in order to subset it.
summary(Household_Pulse_data$RHISPANIC)
length(Household_Pulse_data$RHISPANIC)

# I also changed the list of variables to numeric so that I can potentially use in the analysis. 
Household_Pulse_data$RHISPANIC <- as.numeric(Household_Pulse_data$RHISPANIC)
Household_Pulse_data$RRACE <- as.numeric(Household_Pulse_data$RRACE)
Household_Pulse_data$EEDUC <- as.numeric(Household_Pulse_data$EEDUC)
Household_Pulse_data$RECVDVACC <- as.numeric(Household_Pulse_data$RECVDVACC)
Household_Pulse_data$INCOME <- as.numeric(Household_Pulse_data$INCOME)
Household_Pulse_data$ANXIOUS <- as.numeric(Household_Pulse_data$ANXIOUS)
Household_Pulse_data$REGION <- as.numeric(Household_Pulse_data$REGION)
Household_Pulse_data$GENID_DESCRIBE <- as.numeric(Household_Pulse_data$GENID_DESCRIBE)
Household_Pulse_data$PRIVHLTH <- as.numeric(Household_Pulse_data$PRIVHLTH)
Household_Pulse_data$SEXUAL_ORIENTATION <- as.numeric(Household_Pulse_data$SEXUAL_ORIENTATION)

#First, just to see if we have separate subgroups
list(Household_Pulse_data$INCOME)
list(dat_hispan$INCOME)
# Seems like we do.
summary(Household_Pulse_data)
summary(dat_hispan)
#Comparing the summaries, we see that dat_hispan is indeed a subgroup of just Hispanics.
# I would like to explore differences between household income of the entire sample vs. just subgroup of Hispanics.
# Might be interesting to look at Hispanics, going into the analysis with the assumption that 
# they will have a lower income overall household income compare to the sample. 
# Or since they make less income, there may be a relationship with anxiety levels there 


# Explore where subgroup differs from sample.
hispanic_income <- (Household_Pulse_data$RHISPANIC == 2) & (Household_Pulse_data$INCOME)
regression1 <-  lm(Household_Pulse_data$INCOME ~ hispanic_income)
summary(regression1)
confint(regression1)
# The subgroup of Hispanics does differ from the entire sample, the regression shows
# the coefficient is negative, meaning they make less income compare to the rest of the 
# sample. The Null Hypothesis states there is no significant difference between the dependent
# and independent variables, while the alternative hypothesis states there is a significant difference.
# As for the t-stats, p-values and confidence intervals of the independent variables,
# they all have t-stats is -24.75, the p-values is 2e-16, which is less than the level of significance,
# therefore the the subgroup of Hispanics are statistically significant.
# Thus, we reject the null hypothesis that there is no difference and deem there is sufficient evidence
# to support that the coefficients are different from 0. Additionally, the coefficient falls within
# the the confidence interval at a confidence level of 95%, ranging from -0.8334076 -0.7111021,
# meaning it is expected to cover the true population proportion of Hispanics 95% of the time.
# Since the coefficient of the regression falls within the interval, we are 95% confident that is the true 
# mean of Hispanics, which in this case demonstrates Hispanics have less than the rest of the sample.

#SUBSET
# The second way we interpreted to run the regression was using a direct subset of Hispanics.
dat_hispan <- subset(Household_Pulse_data, Household_Pulse_data$RHISPANIC == 2) 
# I created the subset of just Hispanics, by changing the the factor to numeric
# then sub-setting the data.

hispanic_income <-  dat_hispan$INCOME

regression2 <- lm(SEXUAL_ORIENTATION ~ dat_hispan$SEXUAL_ORIENTATION)


#For the regression, we divide the different income levels, with people making less than $25,000 the lowest
#and people that make at most $199,999 the highest. While intentionally leaving out the group that made over $200,000 
#because adding all the different ranges of a single dummy would make one in the regression an NA.
incomeless25 <-  dat_hispan$INCOME == 1
income25_35 <- dat_hispan$INCOME == 2
income35_45 <- dat_hispan$INCOME == 3
income50_75 <- dat_hispan$INCOME == 4
income75_99 <- dat_hispan$INCOME == 5
income100_149 <- dat_hispan$INCOME == 6
income150_199 <- dat_hispan$INCOME == 7



# We wanted to see whether people would have or not have health insurance based on their income level, so 
# the dependent variable is private health insurance, while the independents are the different income levels.
regression <- lm(dat_hispan$PRIVHLTH ~ incomeless25 + income25_35 + income35_45 + income50_75 + 
                   income75_99 + income100_149 +income150_199 )
summary(regression)
confint(regression)
anova(regression)
# DIFFERENT WAY FOR CONFIDENCE INTERVALS?...

# The null hypothesis is that there is no difference from Hispanics with private health insurance to the different
# levels of income. The regression shows Hispanics with an income of $75,000 or higher has no significant difference because
# they most likely already have private health insurance. So in the case of the variables of Hispanics
# with an income of $75,000 or higher, we fail to reject the null hypothesis because we can see all their p-values
# are higher 0.50819 or higher, which is well above the level of significance and 
# conclude there is no significant difference between those that have private health insurance and those that are wealthy.
# Which makes sense due to the fact that wealthy Hispanics are more likely to afford private
# health insurance. Whereas, Hispanics that have an income of $74,999 or lower demonstrate that there is a significant
# difference because Hispanics with low incomes most likely do NOT have private health insurance. So, Hispanics
# that have an income of $74,999 or lower we reject the null hypothesis (because we can see the p-values that
# are all lower than 0.00134, which is well below the level of significance) in favor of the alternative hypothesis,
# which is there is a significant difference between Hispanics that own private health insurance and people
# with lower income. Ultimately demonstrating a difference from private health insurance and
# Hispanics that do have health insurance, that can be interpreted as, poor Hispanics cannot afford to 
# pay for private health insurance, which is why there is a difference.
# Additionally, when checking whther the coefficient falls within
# the the confidence interval at a confidence level of 95%, ranging from -0.8334076 -0.7111021,
# meaning it is expected to cover the true population proportion of Hispanics 95% of the time.
# Since the coefficient of the regression falls within the interval, we are 95% confident that is the true 
# mean of Hispanics, which in this case demonstrates Hispanics have less than the rest of the sample.



# MAYBE TALK ABOUT CONFIDENCE INTERVALS SOME MORE
confint()

#Now For a Knn of different education levels
less_highschool <- dat_hispan$EEDUC == 1
some_highschool <- dat_hispan$EEDUC == 2
highschool <- dat_hispan$EEDUC == 3
some_college <- dat_hispan$EEDUC == 4
associates <- dat_hispan$EEDUC == 5
bacholers <-   dat_hispan$EEDUC == 6
graduate <- dat_hispan$EEDUC == 7

#delete associates, higher accuracy...
educ_indx <- factor((less_highschool + 2*some_highschool + 3*highschool + 4*some_college + 5*associates), levels=c(1,2,3,4,5),labels = c("Less HS","Some HS","HS","Some College", "Associates"))

norm_varb <- function(X_in) { (X_in - min(X_in, na.rm = TRUE))/( max(X_in, na.rm = TRUE) - min(X_in, na.rm = TRUE) )
}

norm_income <- norm_varb(dat_hispan$INCOME)
norm_private_insurance <- norm_varb(dat_hispan$PRIVHLTH)

data_use_prelim <- data.frame(norm_income, norm_private_insurance)
good_obs_data_use <- complete.cases(data_use_prelim,educ_indx)
dat_use <- subset(data_use_prelim,good_obs_data_use)
y_use <- subset(educ_indx,good_obs_data_use)
set.seed(1)
NN_obs <- sum(good_obs_data_use == 1)
select1 <- (runif(NN_obs) < 0.9)
train_data <- subset(dat_use,select1)
test_data <- subset(dat_use,(!select1))
cl_data <- y_use[select1]
true_data <- y_use[!select1]

summary(cl_data)
prop.table(summary(cl_data))
summary(train_data)
require(class)
for (indx in seq(1, 9, by= 2)) {
  pred_borough <- knn(train_data, test_data, cl_data, k = indx, l = 0, prob = FALSE, use.all = TRUE)
  num_correct_labels <- sum(pred_borough == true_data)
  correct_rate <- num_correct_labels/length(true_data)
  print(c(indx,correct_rate))
}
#THIS WORKKKSSS!!!!!!!!!!

# another hypothesis test could be people that have lower incomes are
# more anxious.

#money causes pvt insurance, not insurance causes money....


#hard to interpret.....
no_anxious <- dat_hispan$ANXIOUS == 1
some_anxious <- dat_hispan$ANXIOUS == 2
very_anxious <- dat_hispan$ANXIOUS == 3
extremely_anxious <- dat_hispan$ANXIOUS == 4

regression1 <- lm(dat_hispan$INCOME ~ no_anxious + some_anxious + very_anxious + extremely_anxious )

summary(regression1)
# The last regression, we want to see whether people's income would affect their level of anxiety.
# For the dependent variable, we set it to Hispanics that make a $150,000-$199,999 income
# and the independent variables are the levels of anxiety.
# The first p-value we see the p-value is below the level of significance, 
# there for there is a difference between Hispanics that are not anxious and Hispanics that are 
# wealthy. The reasons may be because wealthy people have 
# which makes sense considering that having less money
# is more likely to cause stress over financial issues. In this case, it is actually the lack of
# money that may be the cause of anxiety, and not anxiety that is the cause of lack of money.

#do all the basics for the questions, and where is says impress me, go all out, create a bunch of different 
#subgroups, graphs, etc.




xtabs(~ INCOME + EVICT + REGION) 
# An interesting cross tabs is that
# People that have a higher income are less likely to get evicted, while people with 
# less income are more likely to get evicted.

educationsample <- Household_Pulse_data$EEDUC
summary(educationsample)
table(educationsample)
length(educationsample)

educationsubgroup <- dat_hispan$EEDUC
summary(educationsubgroup)
table(educationsubgroup)
length(educationsubgroup)

# When compare the proportions from the sample and subgroup, we can see the difference in median,
# where the sample has both a greater mean and median than the sample does, indicating that
# Hispanics have a lower overall educational level compared to everyone in the sample.


#All of the work on this exam is my own, answered honestly as rules state.
#Name: Nicholas Alonso
#  Date: 10/22/2021







#if we want to use this, must change public health to numeric...
white_healthinurance <- (Household_Pulse_data$RRACE == 1) & (Household_Pulse_data$PRIVHLTH)
black_healthinsurance <- (Household_Pulse_data$RRACE == 2) & (Household_Pulse_data$PRIVHLTH)
dhdhdhdh <- lm(Household_Pulse_data$PUBHLTH ~  white_healthinurance + black_healthinsurance)
summary(dhdhdhdh)

